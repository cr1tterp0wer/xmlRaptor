package Thread;
import java.io.File;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;

import FileIO.FilePool;

public class ThreadPool {
	
	private ExecutorService xmlExecutor,sqlExecutor;
	private String[] credentials;	
	private FilePool filepool;
	private final int MAX_NUM_THREADS = 8;
	private SQLthread sqlThread;

	public ThreadPool(String[] creds, FilePool filepool){
		this.credentials = creds;		
		xmlExecutor = Executors.newFixedThreadPool(MAX_NUM_THREADS);
		this.filepool = filepool;
		sqlThread = new SQLthread(credentials);
	}
	
	public void run(){	
		while(filepool.getFileNameStack().size() > 0){
			Future<String[]> future = xmlExecutor.submit(new XMLThread(new File(filepool.getFileNameStack().pop()), credentials) );
			
			sqlThread.addToFutures(future);
		}
		sqlExecutor = Executors.newCachedThreadPool();
		sqlExecutor.submit(sqlThread);
	}
	
	public void shutdown(){
		xmlExecutor.shutdown();
		//create sql thread
		//sqlExecutor.submit(new SQLThread(FUTURELIST));
	
		
		sqlExecutor.shutdown();	
	}
}